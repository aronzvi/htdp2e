<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- saved from url=(0057)https://course.ccs.neu.edu/cs5010sp15/implementation.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>How to Implement Functions</title><link rel="stylesheet" type="text/css" href="./How to Implement Functions_files/scribble.css" title="default"><link rel="stylesheet" type="text/css" href="./How to Implement Functions_files/racket.css" title="default"><link rel="stylesheet" type="text/css" href="./How to Implement Functions_files/manual-style.css" title="default"><link rel="stylesheet" type="text/css" href="./How to Implement Functions_files/manual-racket.css" title="default"><script type="text/javascript" src="./How to Implement Functions_files/scribble-common.js"></script><script type="text/javascript" src="./How to Implement Functions_files/manual-racket.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tbody><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">►</a></td><td></td><td><a href="https://course.ccs.neu.edu/cs5010sp15/index.html" class="tocviewlink" data-pltdoc="x">CS5010:<span class="mywbr"> &nbsp;</span> Program Design Paradigms (Bootcamp)</a></td></tr></tbody></table></div><div class="tocviewsublisttop" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tbody><tr><td align="right"></td><td><a href="https://course.ccs.neu.edu/cs5010sp15/preclass.html" class="tocviewlink" data-pltdoc="x">Pre-<wbr>Semester Checklist</a></td></tr><tr><td align="right"></td><td><a href="https://course.ccs.neu.edu/cs5010sp15/structure.html" class="tocviewlink" data-pltdoc="x">Course Structure</a></td></tr><tr><td align="right"></td><td><a href="https://course.ccs.neu.edu/cs5010sp15/info.html" class="tocviewlink" data-pltdoc="x">People, Times, and Places</a></td></tr><tr><td align="right"></td><td><a href="https://course.ccs.neu.edu/cs5010sp15/communication.html" class="tocviewlink" data-pltdoc="x">Communication</a></td></tr><tr><td align="right"></td><td><a href="https://course.ccs.neu.edu/cs5010sp15/hw.html" class="tocviewlink" data-pltdoc="x">Homework Policies</a></td></tr><tr><td align="right"></td><td><a href="https://course.ccs.neu.edu/cs5010sp15/grading.html" class="tocviewlink" data-pltdoc="x">Grading</a></td></tr><tr><td align="right"></td><td><a href="https://course.ccs.neu.edu/cs5010sp15/cheating.html" class="tocviewlink" data-pltdoc="x">Please Don’t Cheat</a></td></tr><tr><td align="right"></td><td><a href="https://course.ccs.neu.edu/cs5010sp15/whyracket.html" class="tocviewlink" data-pltdoc="x">Why (Racket)?</a></td></tr><tr><td align="right"></td><td><a href="https://course.ccs.neu.edu/cs5010sp15/textbooks.html" class="tocviewlink" data-pltdoc="x">Textbooks</a></td></tr><tr><td align="right"></td><td><a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html" class="tocviewlink" data-pltdoc="x">The Program Design Recipe</a></td></tr><tr><td align="right"></td><td><a href="https://course.ccs.neu.edu/cs5010sp15/style.html" class="tocviewlink" data-pltdoc="x">Style Guide</a></td></tr><tr><td align="right"></td><td><a href="https://course.ccs.neu.edu/cs5010sp15/predatadefs.html" class="tocviewlink" data-pltdoc="x">Pre-<wbr>defined Data Definitions</a></td></tr><tr><td align="right"></td><td><a href="https://course.ccs.neu.edu/cs5010sp15/files.html" class="tocviewlink" data-pltdoc="x">Files</a></td></tr><tr><td align="right"></td><td><a href="https://course.ccs.neu.edu/cs5010sp15/Modules.html" class="tocviewlink" data-pltdoc="x">Modules</a></td></tr><tr><td align="right"></td><td><a href="https://course.ccs.neu.edu/cs5010sp15/notes.html" class="tocviewselflink" data-pltdoc="x">Other Notes</a></td></tr><tr><td align="right"></td><td><a href="https://course.ccs.neu.edu/cs5010sp15/Homeworks.html" class="tocviewlink" data-pltdoc="x">Homeworks</a></td></tr></tbody></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tbody><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">▼</a></td><td></td><td><a href="https://course.ccs.neu.edu/cs5010sp15/notes.html" class="tocviewlink" data-pltdoc="x">Other Notes</a></td></tr></tbody></table><div class="tocviewsublist" style="display: block;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tbody><tr><td align="right"></td><td><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html" class="tocviewselflink" data-pltdoc="x">How to Implement Functions</a></td></tr><tr><td align="right"></td><td><a href="https://course.ccs.neu.edu/cs5010sp15/set01sol.html" class="tocviewlink" data-pltdoc="x">Problem Set 01 Solution</a></td></tr><tr><td align="right"></td><td><a href="https://course.ccs.neu.edu/cs5010sp15/oop.html" class="tocviewlink" data-pltdoc="x">Interfaces, objects, and dispatching</a></td></tr><tr><td align="right"></td><td><a href="https://course.ccs.neu.edu/cs5010sp15/patterns.html" class="tocviewlink" data-pltdoc="x">Some Design Patterns</a></td></tr><tr><td align="right"></td><td><a href="https://course.ccs.neu.edu/cs5010sp15/mutation.html" class="tocviewlink" data-pltdoc="x">Mutable Objects</a></td></tr><tr><td align="right"></td><td><a href="https://course.ccs.neu.edu/cs5010sp15/inheritance.html" class="tocviewlink" data-pltdoc="x">Inheritance</a></td></tr></tbody></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tbody><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_2&quot;);">►</a></td><td></td><td><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html" class="tocviewselflink" data-pltdoc="x">How to Implement Functions</a></td></tr></tbody></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_2"><table cellspacing="0" cellpadding="0"><tbody><tr><td align="right">1&nbsp;</td><td><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28part._.Libraries_and_.Constants%29" class="tocviewlink" data-pltdoc="x">Libraries and Constants</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28part._.Data_.Definitions%29" class="tocviewlink" data-pltdoc="x">Data Definitions</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28part._run%29" class="tocviewlink" data-pltdoc="x"><span class="stt">run</span></a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28part._draw%29" class="tocviewlink" data-pltdoc="x"><span class="stt">draw</span></a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28part._next-ball%29" class="tocviewlink" data-pltdoc="x"><span class="stt">next-<wbr>ball</span></a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28part._next-ball__.Revisited%29" class="tocviewlink" data-pltdoc="x"><span class="stt">next-<wbr>ball</span>, Revisited</a></td></tr><tr><td align="right">7&nbsp;</td><td><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28part._.Ball-processing_.Functions%29" class="tocviewlink" data-pltdoc="x"><span class="stt">Ball</span>-<wbr>processing Functions</a></td></tr><tr><td align="right">8&nbsp;</td><td><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28part._.Summary%29" class="tocviewlink" data-pltdoc="x">Summary</a></td></tr></tbody></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tbody><tr><td><span class="tocsublinknumber">1<tt>&nbsp;</tt></span><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28part._.Libraries_and_.Constants%29" class="tocsubseclink" data-pltdoc="x">Libraries and Constants</a></td></tr><tr><td><span class="tocsublinknumber">2<tt>&nbsp;</tt></span><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28part._.Data_.Definitions%29" class="tocsubseclink" data-pltdoc="x">Data Definitions</a></td></tr><tr><td><span class="tocsublinknumber">3<tt>&nbsp;</tt></span><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28part._run%29" class="tocsubseclink" data-pltdoc="x"><span class="stt">run</span></a></td></tr><tr><td><span class="tocsublinknumber">4<tt>&nbsp;</tt></span><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28part._draw%29" class="tocsubseclink" data-pltdoc="x"><span class="stt">draw</span></a></td></tr><tr><td><span class="tocsublinknumber">5<tt>&nbsp;</tt></span><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28part._next-ball%29" class="tocsubseclink" data-pltdoc="x"><span class="stt">next-<wbr>ball</span></a></td></tr><tr><td><span class="tocsublinknumber">5.1<tt>&nbsp;</tt></span><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28part._.An_.Ambiguity%29" class="tocsubseclink" data-pltdoc="x">An Ambiguity</a></td></tr><tr><td><span class="tocsublinknumber">5.2<tt>&nbsp;</tt></span><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28part._next-x%29" class="tocsubseclink" data-pltdoc="x"><span class="stt">next-<wbr>x</span></a></td></tr><tr><td><span class="tocsublinknumber">5.3<tt>&nbsp;</tt></span><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28part._next-x_.Review%29" class="tocsubseclink" data-pltdoc="x"><span class="stt">next-<wbr>x</span> Review</a></td></tr><tr><td><span class="tocsublinknumber">6<tt>&nbsp;</tt></span><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28part._next-ball__.Revisited%29" class="tocsubseclink" data-pltdoc="x"><span class="stt">next-<wbr>ball</span>, Revisited</a></td></tr><tr><td><span class="tocsublinknumber">7<tt>&nbsp;</tt></span><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28part._.Ball-processing_.Functions%29" class="tocsubseclink" data-pltdoc="x"><span class="stt">Ball</span>-<wbr>processing Functions</a></td></tr><tr><td><span class="tocsublinknumber">7.1<tt>&nbsp;</tt></span><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28part._ball-off-canvas_%29" class="tocsubseclink" data-pltdoc="x"><span class="stt">ball-<wbr>off-<wbr>canvas?</span></a></td></tr><tr><td><span class="tocsublinknumber">7.2<tt>&nbsp;</tt></span><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28part._ball-forward%29" class="tocsubseclink" data-pltdoc="x"><span class="stt">ball-<wbr>forward</span></a></td></tr><tr><td><span class="tocsublinknumber">7.3<tt>&nbsp;</tt></span><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28part._ball-reverse-direction%29" class="tocsubseclink" data-pltdoc="x"><span class="stt">ball-<wbr>reverse-<wbr>direction</span></a></td></tr><tr><td><span class="tocsublinknumber">7.4<tt>&nbsp;</tt></span><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28part._ball-to-edge%29" class="tocsubseclink" data-pltdoc="x"><span class="stt">ball-<wbr>to-<wbr>edge</span></a></td></tr><tr><td><span class="tocsublinknumber">8<tt>&nbsp;</tt></span><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28part._.Summary%29" class="tocsubseclink" data-pltdoc="x">Summary</a></td></tr></tbody></table></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="https://course.ccs.neu.edu/cs5010sp15/notes.html" title="backward to &quot;Other Notes&quot;" data-pltdoc="x">← prev</a>&nbsp;&nbsp;<a href="https://course.ccs.neu.edu/cs5010sp15/notes.html" title="up to &quot;Other Notes&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="https://course.ccs.neu.edu/cs5010sp15/set01sol.html" title="forward to &quot;Problem Set 01 Solution&quot;" data-pltdoc="x">next →</a></span>&nbsp;</div><h4><a name="(part._implementation)"></a>How to Implement Functions</h4><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p><span style="font-style: italic">Last updated: </span>Fri, 16 Jan 2015 15:10:18 -0500</p></blockquote></blockquote></blockquote><p>The <a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28part._spec%29" data-pltdoc="x">Function Specification</a> step of <a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html" data-pltdoc="x">The Program Design Recipe</a> thoroughly describes how to explain
the behavior of a function at a high level via <a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28tech._data._definition%29" class="techoutside" data-pltdoc="x"><span class="techinside">data definitions</span></a>,
English prose, and examples.
The recipe provides less guidance, however, on
<a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28part._impl%29" data-pltdoc="x">how to write the function’s code</a>.</p><p>The <a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28tech._data._decomposition%29" class="techoutside" data-pltdoc="x"><span class="techinside">data decomposition</span></a> strategy dictates a starting
<a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28tech._template%29" class="techoutside" data-pltdoc="x"><span class="techinside">template</span></a>, such that the shape of the function’s code mirrors the shape
of its input data.
But how does one choose a strategy in the first place?</p><p></p><div class="SIntrapara">Thus far, we’ve introduced two <a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28tech._design._strategy%29" class="techoutside" data-pltdoc="x"><span class="techinside">design strategies</span></a>:
</div><div class="SIntrapara"><ul><li><p><a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28tech._function._composition%29" class="techoutside" data-pltdoc="x"><span class="techinside">function composition</span></a></p></li><li><p>and <a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28tech._data._decomposition%29" class="techoutside" data-pltdoc="x"><span class="techinside">data decomposition</span></a>.</p></li></ul></div><p></p><p>Which strategy is better for a given situation? This page provides guidelines
for choosing a strategy, as well as other guidelines to keep in mind while
designing the code for a function.</p><p></p><div class="SIntrapara">The guidelines are further categorized as:
</div><div class="SIntrapara"><ul><li><p><span style="font-style: italic">process</span> guidelines, which should be followed when coding a
 function for the first time,</p></li><li><p>and <span style="font-style: italic">review</span> guidelines, which you should apply during the
<a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28part._review%29" data-pltdoc="x">review</a> step after you’ve written a first draft of a
function.</p></li></ul></div><p></p><p>We will use a running example to introduce and illustrate the guidelines:</p><blockquote><p>Write a <span class="RktSym"><a href="http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> program that simulates a red ball moving
horizontally at a constant speed of 9 pixels/tick. The canvas dimensions are
400 x 400 pixels and the ball has a radius of 40 pixels and starts in the
middle of the canvas.</p><p>On a tick, if any part of the ball would move <a name="(tech._off._the._canva)"></a><span style="font-style: italic">off the canvas</span>,
the ball is
instead positioned flush against the edge it just passed, moving in the
opposite direction. Thus, the ball should bounce back and forth between the
left and right edges of the canvas, as shown.</p><blockquote class="SCentered"><p><img src="./How to Implement Functions_files/ball.gif" alt="" width="100" height="100"></p></blockquote></blockquote><p></p><div class="SIntrapara">Some things to keep in mind while reading the tutorial:
</div><div class="SIntrapara"><ul><li><p>This tutorial is just one example of how you might devise a solution to
the problem, but it is not the only path. The intention is to introduce
some important general guidelines that you should follow for when you do
your own programming.</p></li><li><p>Points may not necessarily be deducted for violating these guidelines,
as there may not be an "optimal" solution to any given problem. But any
deviation from the guidelines should be supported with pros and cons
of your design decision as well as possible alternatives. Be prepared
to discuss these tradeoffs during your code walk.</p></li><li><p>This tutorial focuses on the <a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28part._impl%29" data-pltdoc="x">Function Implementation</a> step of the design recipe.
Thus, the guidelines complement the guidelines you’ve already learned for the
other recipe steps.</p></li></ul></div><p></p><h5>1<tt>&nbsp;</tt><a name="(part._.Libraries_and_.Constants)"></a>Libraries and Constants</h5><p>We use the <span class="stt">Beginning Student Language</span> and the following libraries to
implement our program:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym">2htdp/universe</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym">2htdp/image</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym">rackunit</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><a href="https://course.ccs.neu.edu/cs5010sp15/files/extras.rkt">"extras.rkt"</a><span class="RktPn">)</span></td></tr></tbody></table></blockquote><p>We also define some constants based on information from the problem description.</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">canvas constants</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">CENTER-X</span><span class="hspace">&nbsp;</span><span class="RktVal">200</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">pixels</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">CENTER-Y</span><span class="hspace">&nbsp;</span><span class="RktVal">200</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">pixels</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">WIDTH</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktSym">CENTER-X</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">pixels</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktSym">CENTER-Y</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">pixels</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">EMPTY-SCENE</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._empty-scene%29%29" class="RktValLink" data-pltdoc="x">empty-scene</a></span><span class="hspace">&nbsp;</span><span class="RktSym">WIDTH</span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt"><a href="https://course.ccs.neu.edu/cs5010sp15/predatadefs.html#%28part._image%29" data-pltdoc="x">Image</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Ball constants</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">BALL-RADIUS</span><span class="hspace">&nbsp;</span><span class="RktVal">40</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">pixels</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">BALL-IMG</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._circle%29%29" class="RktValLink" data-pltdoc="x">circle</a></span><span class="hspace">&nbsp;</span><span class="RktSym">BALL-RADIUS</span><span class="hspace">&nbsp;</span><span class="RktVal">"solid"</span><span class="hspace">&nbsp;</span><span class="RktVal">"red"</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt"><a href="https://course.ccs.neu.edu/cs5010sp15/predatadefs.html#%28part._image%29" data-pltdoc="x">Image</a></span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">VELOCITY</span><span class="hspace">&nbsp;</span><span class="RktVal">9</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">pixels/tick</span></td></tr></tbody></table></blockquote><h5>2<tt>&nbsp;</tt><a name="(part._.Data_.Definitions)"></a>Data Definitions</h5><p>Following <a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html" data-pltdoc="x">The Program Design Recipe</a>, we first define <a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28tech._data._definition%29" class="techoutside" data-pltdoc="x"><span class="techinside">data definitions</span></a>.
Since we wish to call <span class="RktSym"><a href="http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span>, we need a <span class="stt">World</span>
data definition. Thinking about what objects we need to represent and what
values are changing on each tick, we come up with the following data
definitions and accompanying <a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28part._data%29" data-pltdoc="x">Data Design</a> requirements.</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><a name="(tech._direction)"></a><span style="font-style: italic">Direction</span><span class="RktCmt"> is one of:</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">- "right"</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">- "left"</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">INTERP: represents a canvas direction where "right" is x-increasing.</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">RIGHT</span><span class="hspace">&nbsp;</span><span class="RktVal">"right"</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">LEFT</span><span class="hspace">&nbsp;</span><span class="RktVal">"left"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">&lt;direction predicates&gt; : </span><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28tech._direction%29" class="techoutside" data-pltdoc="x"><span class="techinside">Direction</span></a><span class="RktCmt"> -&gt; </span><a href="https://course.ccs.neu.edu/cs5010sp15/predatadefs.html#%28tech._boolean%29" class="techoutside" data-pltdoc="x"><span class="techinside">Boolean</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Returns true if d is the Direction indicated by the function name.</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">STRATEGY: function composition</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">right?</span><span class="hspace">&nbsp;</span><span class="RktSym">d</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">d</span><span class="hspace">&nbsp;</span><span class="RktSym">RIGHT</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">left?</span><span class="hspace">&nbsp;</span><span class="RktSym">d</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">d</span><span class="hspace">&nbsp;</span><span class="RktSym">LEFT</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">TEMPLATE</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a name="(tech._direction._fn)"></a><span style="font-style: italic">direction-fn</span><span class="RktCmt"> : </span><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28tech._direction%29" class="techoutside" data-pltdoc="x"><span class="techinside">Direction</span></a><span class="RktCmt"> -&gt; ???</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">direction-fn</span><span class="hspace">&nbsp;</span><span class="RktSym">dir</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">right?</span><span class="hspace">&nbsp;</span><span class="RktSym">dir</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">left?</span><span class="hspace">&nbsp;</span><span class="RktSym">dir</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><a name="(tech._ball)"></a><span style="font-style: italic">Ball</span><span class="RktCmt"> is a (make-ball </span><a href="https://course.ccs.neu.edu/cs5010sp15/predatadefs.html#%28tech._coordinate%29" class="techoutside" data-pltdoc="x"><span class="techinside">Coordinate</span></a><span class="RktCmt"> </span><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28tech._direction%29" class="techoutside" data-pltdoc="x"><span class="techinside">Direction</span></a><span class="RktCmt">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">INTERP: The Coordinate is the ball</span><span class="RktCmt">'</span><span class="RktCmt">s x position.</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ball</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">dir</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><a name="(tech._init._ball)"></a><span style="font-style: italic">INIT-BALL</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-ball</span><span class="hspace">&nbsp;</span><span class="RktSym">CENTER-X</span><span class="hspace">&nbsp;</span><span class="RktSym">RIGHT</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">INIT-BALL-LEFT</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-ball</span><span class="hspace">&nbsp;</span><span class="RktSym">CENTER-X</span><span class="hspace">&nbsp;</span><span class="RktSym">LEFT</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><a name="(tech._ball._x._right._edge)"></a><span style="font-style: italic">BALL-X-RIGHT-EDGE</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym">WIDTH</span><span class="hspace">&nbsp;</span><span class="RktSym">BALL-RADIUS</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">x </span><a href="https://course.ccs.neu.edu/cs5010sp15/predatadefs.html#%28tech._coordinate%29" class="techoutside" data-pltdoc="x"><span class="techinside">Coordinate</span></a></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">BALL-X-LEFT-EDGE</span><span class="hspace">&nbsp;</span><span class="RktSym">BALL-RADIUS</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">x </span><a href="https://course.ccs.neu.edu/cs5010sp15/predatadefs.html#%28tech._coordinate%29" class="techoutside" data-pltdoc="x"><span class="techinside">Coordinate</span></a></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><a name="(tech._ball._at._right._edge)"></a><span style="font-style: italic">BALL-AT-RIGHT-EDGE</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-ball</span><span class="hspace">&nbsp;</span><span class="RktSym">BALL-X-RIGHT-EDGE</span><span class="hspace">&nbsp;</span><span class="RktSym">LEFT</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><a name="(tech._ball._at._left._edge)"></a><span style="font-style: italic">BALL-AT-LEFT-EDGE</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-ball</span><span class="hspace">&nbsp;</span><span class="RktSym">BALL-X-LEFT-EDGE</span><span class="hspace">&nbsp;</span><span class="RktSym">RIGHT</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">TEMPLATE:</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a name="(tech._ball._fn)"></a><span style="font-style: italic">ball-fn</span><span class="RktCmt"> : </span><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28tech._ball%29" class="techoutside" data-pltdoc="x"><span class="techinside">Ball</span></a><span class="RktCmt"> -&gt; ???</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-fn</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-x</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28tech._direction._fn%29" class="techoutside" data-pltdoc="x"><span class="techinside">direction-fn</span></a><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-dir</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><a name="(tech._world)"></a><span style="font-style: italic">World</span><span class="RktCmt"> is a </span><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28tech._ball%29" class="techoutside" data-pltdoc="x"><span class="techinside">Ball</span></a></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">INIT-WORLD</span><span class="hspace">&nbsp;</span><span class="RktSym">INIT-BALL</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote><p>Note the call to <span class="stt">direction-fn</span> in <span class="stt">Ball</span>’s template. Restricting
functions to decomposing only one kind of data helps ensure that each function
adheres to performing only one distinct task.</p><blockquote><p class="boxed"><span style="font-weight: bold">Process Guideline 1: </span><a name="(tech._gl~3ano._double._decomp)"></a><span style="font-style: italic">Decompose one kind of data per function.</span></p></blockquote><h5>3<tt>&nbsp;</tt><a name="(part._run)"></a><span class="stt">run</span></h5><p>To start, we define <span class="stt">run</span>, which calls <span class="RktSym"><a href="http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span>.</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">run : World -&gt; World</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Starts the simulation.</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">STRATEGY: function composition</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">run</span><span class="hspace">&nbsp;</span><span class="RktSym">init-world</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktSym">init-world</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._on-tick%29%29" class="RktStxLink" data-pltdoc="x">on-tick</a></span><span class="hspace">&nbsp;</span><span class="RktSym">next-world</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._to-draw%29%29" class="RktStxLink" data-pltdoc="x">to-draw</a></span><span class="hspace">&nbsp;</span><span class="RktSym">draw</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote><p>We utilize a <a href="http://www.ccs.neu.edu/home/matthias/HtDP2e/Draft/part_one.html#%28part._sec~3adesign%29">wish list</a> to remember what other functions we
need to implement.</p><p></p><div class="SIntrapara"><span style="font-weight: bold">Wish List</span>:
</div><div class="SIntrapara"><ul><li><table cellspacing="0" cellpadding="0" class="RktBlk" style="display: inline-table; vertical-align: text-top;"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">next-world : World -&gt; World</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Computes the next World state.</span></td></tr></tbody></table></li><li><table cellspacing="0" cellpadding="0" class="RktBlk" style="display: inline-table; vertical-align: text-top;"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">draw : World -&gt; Image</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Renders the current World state into an Image.</span></td></tr></tbody></table></li></ul></div><p></p><blockquote><p class="boxed"><span style="font-weight: bold">Process Guideline 2: </span><a name="(tech._gl~3awish._list)"></a><span style="font-style: italic">Use a wish list to organize and document your
progress as you write a program.</span></p></blockquote><p>It’s a good idea to record your wish list somewhere where you can refer back to it,
since you may be asked about it during your code walk.</p><h5>4<tt>&nbsp;</tt><a name="(part._draw)"></a><span class="stt">draw</span></h5><p>Our wish list contains <span class="stt">next-world</span> and <span class="stt">draw</span>.
The <span class="stt">draw</span> function seems straighforward so we implement it first.</p><p></p><div class="SIntrapara">Following the design recipe:
</div><div class="SIntrapara"><ul><li><p>We first write the function’s <a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28part._spec%29" data-pltdoc="x">specification</a>.</p></li><li><p>Since a <span class="stt">World</span> is a <span class="stt">Ball</span>, we dispatch to a <span class="stt">draw-ball-on</span>
function, which draws a <span class="stt">Ball</span> on a given canvas.</p></li><li><p></p><div class="SIntrapara">Since <span class="stt">draw-ball-on</span> processes <a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28tech._compound._data%29" class="techoutside" data-pltdoc="x"><span class="techinside">compound data</span></a>, we choose the
<a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28tech._data._decomposition%29" class="techoutside" data-pltdoc="x"><span class="techinside">data decomposition</span></a> (on <span class="stt">Ball</span>) <a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28tech._design._strategy%29" class="techoutside" data-pltdoc="x"><span class="techinside">design strategy</span></a>.
</div><div class="SIntrapara"><blockquote><p class="boxed"><span style="font-weight: bold">Process Guideline 3: </span><a name="(tech._gl~3acompound._data._decomp)"></a><span style="font-style: italic">For functions with <a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28tech._compound._data%29" class="techoutside" data-pltdoc="x"><span class="techinside">compound data</span></a> or
<a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28tech._itemization._data%29" class="techoutside" data-pltdoc="x"><span class="techinside">itemization data</span></a> inputs, start with a
<a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28tech._data._decomposition%29" class="techoutside" data-pltdoc="x"><span class="techinside">data decomposition</span></a> strategy, otherwise use
<a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28tech._function._composition%29" class="techoutside" data-pltdoc="x"><span class="techinside">function composition</span></a>.</span></p></blockquote></div><p></p></li><li><p>The data decomposition strategy dictates that <span class="stt">draw-ball-on</span> start with
the <a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28tech._ball._fn%29" class="techoutside" data-pltdoc="x"><span class="techinside"><span class="techoutside"><span class="techinside">template</span></span> for <span class="stt">Ball</span></span></a>. We then fill
in the "<span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span>" to combine the pieces of the template.
In this case, we only use the <span class="stt">x</span> component.</p></li><li><p>We finish by writing some tests.</p></li></ul></div><p></p><p>Here is the result:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">draw : </span><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28tech._world%29" class="techoutside" data-pltdoc="x"><span class="techinside">World</span></a><span class="RktCmt"> -&gt; </span><a href="https://course.ccs.neu.edu/cs5010sp15/predatadefs.html#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Renders the current World state.</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">STRATEGY: function composition</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">draw</span><span class="hspace">&nbsp;</span><span class="RktSym">w</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">draw-ball-on</span><span class="hspace">&nbsp;</span><span class="RktSym">w</span><span class="hspace">&nbsp;</span><span class="RktSym">EMPTY-SCENE</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">draw-ball-on : </span><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28tech._ball%29" class="techoutside" data-pltdoc="x"><span class="techinside">Ball</span></a><span class="RktCmt"> </span><a href="https://course.ccs.neu.edu/cs5010sp15/predatadefs.html#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a><span class="RktCmt"> -&gt; </span><a href="https://course.ccs.neu.edu/cs5010sp15/predatadefs.html#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Draws Ball b onto Image img.</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">WHERE: BALL-RADIUS &lt;= (ball-x b) &lt;= ((image-width img) - BALL-RADIUS)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">(Ball b is completely within img.)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">STRATEGY: data decomposition on b : Ball</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">draw-ball-on</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="hspace">&nbsp;</span><span class="RktSym">img</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span><span class="hspace">&nbsp;</span><span class="RktSym">BALL-IMG</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-x</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">CENTER-Y</span><span class="hspace">&nbsp;</span><span class="RktSym">img</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">begin-for-test</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/rackunit/api.html#%28def._%28%28lib._rackunit%2Fmain..rkt%29._check-equal~3f%29%29" class="RktValLink" data-pltdoc="x">check-equal?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">draw</span><span class="hspace">&nbsp;</span><span class="RktSym">INIT-BALL</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span><span class="hspace">&nbsp;</span><span class="RktSym">BALL-IMG</span><span class="hspace">&nbsp;</span><span class="RktSym">CENTER-X</span><span class="hspace">&nbsp;</span><span class="RktSym">CENTER-Y</span><span class="hspace">&nbsp;</span><span class="RktSym">EMPTY-SCENE</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/rackunit/api.html#%28def._%28%28lib._rackunit%2Fmain..rkt%29._check-equal~3f%29%29" class="RktValLink" data-pltdoc="x">check-equal?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">draw</span><span class="hspace">&nbsp;</span><span class="RktSym">BALL-AT-LEFT-EDGE</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span><span class="hspace">&nbsp;</span><span class="RktSym">BALL-IMG</span><span class="hspace">&nbsp;</span><span class="RktSym">BALL-X-LEFT-EDGE</span><span class="hspace">&nbsp;</span><span class="RktSym">CENTER-Y</span><span class="hspace">&nbsp;</span><span class="RktSym">EMPTY-SCENE</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote><p></p><div class="SIntrapara">Commentary:
</div><div class="SIntrapara"><ul><li><p>Function examples are less important here since <span class="stt">draw</span> produces an
Image, so we leave them out (but we still must have sufficient tests).</p></li><li><p>In this example, a <span class="stt">World</span> is just a <span class="stt">Ball</span> so <span class="stt">draw</span>
just calls <span class="stt">draw-ball-on</span>. Two separate functions are
 not strictly needed here, but this way, we keep the concept of
 <span class="stt">World</span> and <span class="stt">Ball</span> separate, which makes it easier to
 change the <span class="stt">World</span> definition later if necessary.</p></li><li><p><span class="stt">draw-ball-on</span>’s signature allows any <span class="stt">Ball</span> and <span class="stt">Image</span> input.
Since we know the given <span class="stt">Ball</span> is always on the canvas, however,
we add an <a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28tech._argument._invariant%29" class="techoutside" data-pltdoc="x"><span class="techinside">argument invariant</span></a> to capture this additional
information. This restricts what <span class="stt">Ball</span> values <span class="stt">draw-ball-on</span>
accepts, making the function specification more precise. This also means
that while writing the function, we don’t need to worry about cases where
the <span class="stt">Ball</span> is off the canvas and we can omit tests for these cases as well.</p></li></ul></div><p></p><h5>5<tt>&nbsp;</tt><a name="(part._next-ball)"></a><span class="stt">next-ball</span></h5><p>Finally, we implement <span class="stt">next-ball</span>. Again following <a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html" data-pltdoc="x">The Program Design Recipe</a>, we
come up with the <a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28part._spec%29" data-pltdoc="x">Function Specification</a>. For this function,
examples are crucial in explaining its behavior, particularly for the edge cases.
Since we are again processing <a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28tech._compound._data%29" class="techoutside" data-pltdoc="x"><span class="techinside">compound data</span></a>, we
<a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28tech._gl~3acompound._data._decomp%29" data-pltdoc="x">initially choose</a> the
<a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28tech._data._decomposition%29" class="techoutside" data-pltdoc="x"><span class="techinside">data decomposition</span></a> strategy and start with <span class="stt">Ball</span>’s template.</p><p>So far, our <span class="stt">next-ball</span> looks like:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">BALL-NEAR-RIGHT-EDGE</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-ball</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._sub1%29%29" class="RktValLink" data-pltdoc="x">sub1</a></span><span class="hspace">&nbsp;</span><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28tech._ball._x._right._edge%29" class="techoutside" data-pltdoc="x"><span class="techinside">BALL-X-RIGHT-EDGE</span></a><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">RIGHT</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">BALL-1TICK-FROM-RIGHT-EDGE</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-ball</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28tech._ball._x._right._edge%29" class="techoutside" data-pltdoc="x"><span class="techinside">BALL-X-RIGHT-EDGE</span></a><span class="hspace">&nbsp;</span><span class="RktSym">VELOCITY</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">RIGHT</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">BALL-AT-RIGHT-EDGE-MOVING-RIGHT</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-ball</span><span class="hspace">&nbsp;</span><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28tech._ball._x._right._edge%29" class="techoutside" data-pltdoc="x"><span class="techinside">BALL-X-RIGHT-EDGE</span></a><span class="hspace">&nbsp;</span><span class="RktSym">RIGHT</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">next-ball : Ball -&gt; Ball</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Computes the next ball state.</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">WHERE: Ball b is completely on the canvas.</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">EXAMPLES:</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">begin-for-test</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/rackunit/api.html#%28def._%28%28lib._rackunit%2Fmain..rkt%29._check-equal~3f%29%29" class="RktValLink" data-pltdoc="x">check-equal?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">next-ball</span><span class="hspace">&nbsp;</span><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28tech._init._ball%29" class="techoutside" data-pltdoc="x"><span class="techinside">INIT-BALL</span></a><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-ball</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">CENTER-X</span><span class="hspace">&nbsp;</span><span class="RktSym">VELOCITY</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">RIGHT</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/rackunit/api.html#%28def._%28%28lib._rackunit%2Fmain..rkt%29._check-equal~3f%29%29" class="RktValLink" data-pltdoc="x">check-equal?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">next-ball</span><span class="hspace">&nbsp;</span><span class="RktSym">BALL-NEAR-RIGHT-EDGE</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28tech._ball._at._right._edge%29" class="techoutside" data-pltdoc="x"><span class="techinside">BALL-AT-RIGHT-EDGE</span></a><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/rackunit/api.html#%28def._%28%28lib._rackunit%2Fmain..rkt%29._check-equal~3f%29%29" class="RktValLink" data-pltdoc="x">check-equal?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">next-ball</span><span class="hspace">&nbsp;</span><span class="RktSym">BALL-1TICK-FROM-RIGHT-EDGE</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28tech._ball._at._right._edge%29" class="techoutside" data-pltdoc="x"><span class="techinside">BALL-AT-RIGHT-EDGE</span></a><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/rackunit/api.html#%28def._%28%28lib._rackunit%2Fmain..rkt%29._check-equal~3f%29%29" class="RktValLink" data-pltdoc="x">check-equal?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">next-ball</span><span class="hspace">&nbsp;</span><span class="RktSym">BALL-AT-RIGHT-EDGE-MOVING-RIGHT</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">???</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">STRATEGY: data decomposition on b : Ball</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">next-ball</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-x</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">direction-fn</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-dir</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote><h5>5.1<tt>&nbsp;</tt><a name="(part._.An_.Ambiguity)"></a>An Ambiguity</h5><p>While writing <a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28part._spec~3aexamples%29" data-pltdoc="x">Function Examples</a> for <span class="stt">next-ball</span>, we came up
with an example (indicated by the <span class="stt">???</span>) where we are unsure what
the expected result should be. What should be the next state for a
ball at the right edge, moving <span class="stt">RIGHT</span>? Apparently, the specification
says that it should again be touching the right edge, but moving <span class="stt">LEFT</span>.
But this feels counter-intuitive; shouldn’t the ball still change position in that
situation? Did we interpret the specification correctly? Do we understand
what the problem meant by "off the canvas" and such terms?</p><p>Oftentimes a problem statement is ambiguous about how exactly the program
should behave, or our intuition leads us to doubt the literal statement
of the problem itself.</p><p>Indeed, <a href="http://accu.org/index.php/journals/319">ambiguities and confusions
are certain to occur</a> when writing any program, whether in an academic
or a professional setting. In this class, when you think the problem
description is ambiguous or unclear, you should carefully re-read it
to see if it explains the expected behavior. In this case, it does
not. Specifically, the words "<a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28tech._off._the._canva%29" class="techoutside" data-pltdoc="x"><span class="techinside">off the canvas</span></a>" are ambiguous, since we
don’t know <span style="font-style: italic">exactly</span> which pixel constitutes "off the canvas."</p><p>When this occurs in practice, you should consult your client or
colleagues about the appropriate behavior. In this class, you should
<a href="https://course.ccs.neu.edu/cs5010sp15/communication.html" data-pltdoc="x">ask the course staff to clarify</a>. We may not
always provide an exact answer, just like your clients may not always
know what they want, in which case you need to choose a reasonable
behavior. Be prepared to explain the reasoning supporting your choices
in your code walk.</p><p>How shall we resolve our example? In this case, there is a clever
trick we can use. To avoid having the <span class="stt">Ball</span> remain idle during a
tick, we can consider <span class="stt">(make-ball BALL-X-RIGHT-EDGE LEFT)</span> "on"
canvas while <span class="stt">(make-ball BALL-X-RIGHT-EDGE RIGHT)</span> is "off"
canvas. Stop for a moment to think about how this changes our dilemma.
Think about how we arrive at each state, as well as what happens
after that state.</p><p>Have you thought it through? OK, here’s how it’s different: by
defining <span class="stt">(make-ball BALL-X-RIGHT-EDGE RIGHT)</span> to be "off canvas,"
we ensured that our problematic situation should not have occurred in
the first place. As the ball approaches the right edge, if it hits
<span class="stt">BALL-X-RIGHT-EDGE</span> exactly, then it is already off-canvas, and its
next state has heading <span class="stt">LEFT</span>. In particular, by ruling out this
boundary case (and declaring that we did so) we’ve avoided the need to
test it. Note that you must declare an invariant if you do so; and you
have to be sure that your own code won’t violate the invariant!
(That’s the meaning of an invariant: something whose truth <span style="font-style: italic">does
not vary</span>.)</p><p>You should be prepared to give an explanation like this during a code
walk if asked about how you resolved an ambiguous situation.</p><p>Ruling out certain inputs doesn’t always get you out of a jam, but
when it’s a close matter of one pixel plus or minus, it may be just
what you need.</p><p>Thus we update the <a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28tech._argument._invariant%29" class="techoutside" data-pltdoc="x"><span class="techinside">argument invariant</span></a> to state that the input
ball must be on-canvas in this precise sense, and then leave off the
last example.</p><blockquote><p class="boxed"><span style="font-weight: bold">Process Guideline 4: </span><a name="(tech._gl~3aambiguity)"></a><span style="font-style: italic">When encountering ambiguous behavior, ask for clarification, and
then make a reasonable decision if necessary. Be prepared to
explain your decision during a code walk.</span></p></blockquote><h5>5.2<tt>&nbsp;</tt><a name="(part._next-x)"></a><span class="stt">next-x</span></h5><p>Now we wish to complete our implementation of <span class="stt">next-ball</span>. To do so, we need
to compute the next <span class="stt">x</span> position and the next <span class="stt">Direction</span>.</p><p>To compute the next <span class="stt">x</span>, we need to either
add or subtract <span class="stt">VELOCITY</span>, depending on the ball’s direction. Since
<a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28tech._gl~3ano._double._decomp%29" class="techoutside" data-pltdoc="x"><span class="techinside">we don’t
want to decompose more than one kind of data in one function</span></a>, we define a new
function that decomposes a <span class="stt">Direction</span>. Let’s try writing it like this:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">next-ball : Ball -&gt; Ball</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Computes the next ball state.</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">WHERE: Ball b is completely on the canvas.</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">STRATEGY: data decomposition on b : Ball</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">next-ball</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">next-x</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-x</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-dir</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">direction-fn</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-dir</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">next-x : Coordinate Direction -&gt; Coordinate</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Computes the next x position in Direction dir.</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">STRATEGY: data decomposition on dir : Direction</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">next-x.v1</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">dir</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">left?</span><span class="hspace">&nbsp;</span><span class="RktSym">dir</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">VELOCITY</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">right?</span><span class="hspace">&nbsp;</span><span class="RktSym">dir</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">VELOCITY</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote><p>(We add the <span class="stt">.v1</span> suffix to better track our progress, but assume the function
name is always <span class="stt">next-x</span>.)</p><p>We leave out function examples since we already considered the possible behaviors
in the <span class="stt">next-ball</span> examples.</p><p>Of course, <span class="stt">next-x</span> may move the ball off the canvas. To handle this,
we might update <span class="stt">next-x</span> to something like:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">next-x : Coordinate Direction -&gt; Coordinate</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Computes the next x position in Direction dir.</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">If any part of a Ball with the computed x position would be off the canvas</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">then instead return an x position such that the Ball is flush with the</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">nearest canvas edge.</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">STRATEGY: data decomposition on dir : Direction</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">next-x.v2</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">dir</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">left?</span><span class="hspace">&nbsp;</span><span class="RktSym">dir</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._if%29%29" class="RktStxLink" data-pltdoc="x">if</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">VELOCITY</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">BALL-X-LEFT-EDGE</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">BALL-X-LEFT-EDGE</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">VELOCITY</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">right?</span><span class="hspace">&nbsp;</span><span class="RktSym">dir</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._if%29%29" class="RktStxLink" data-pltdoc="x">if</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3e~3d%29%29" class="RktValLink" data-pltdoc="x">&gt;=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">VELOCITY</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">BALL-X-RIGHT-EDGE</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">BALl-X-RIGHT-EDGE</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">VELOCITY</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote><p>Adding tests, one <a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28part._test~3aequiv%29" data-pltdoc="x">partition</a> per combination of inputs,
confirms that our function behaves as expected.</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym">begin-for-test</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/rackunit/api.html#%28def._%28%28lib._rackunit%2Fmain..rkt%29._check-equal~3f%29%29" class="RktValLink" data-pltdoc="x">check-equal?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">next-x</span><span class="hspace">&nbsp;</span><span class="RktSym">CENTER-X</span><span class="hspace">&nbsp;</span><span class="RktSym">RIGHT</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">CENTER-X</span><span class="hspace">&nbsp;</span><span class="RktSym">VELOCITY</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/rackunit/api.html#%28def._%28%28lib._rackunit%2Fmain..rkt%29._check-equal~3f%29%29" class="RktValLink" data-pltdoc="x">check-equal?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">next-x</span><span class="hspace">&nbsp;</span><span class="RktSym">CENTER-X</span><span class="hspace">&nbsp;</span><span class="RktSym">LEFT</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym">CENTER-X</span><span class="hspace">&nbsp;</span><span class="RktSym">VELOCITY</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/rackunit/api.html#%28def._%28%28lib._rackunit%2Fmain..rkt%29._check-equal~3f%29%29" class="RktValLink" data-pltdoc="x">check-equal?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">next-x</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._sub1%29%29" class="RktValLink" data-pltdoc="x">sub1</a></span><span class="hspace">&nbsp;</span><span class="RktSym">BALL-X-RIGHT-EDGE</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">RIGHT</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">BALL-X-RIGHT-EDGE</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/rackunit/api.html#%28def._%28%28lib._rackunit%2Fmain..rkt%29._check-equal~3f%29%29" class="RktValLink" data-pltdoc="x">check-equal?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">next-x</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._add1%29%29" class="RktValLink" data-pltdoc="x">add1</a></span><span class="hspace">&nbsp;</span><span class="RktSym">BALL-X-LEFT-EDGE</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">LEFT</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">BALL-X-LEFT-EDGE</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote><h5>5.3<tt>&nbsp;</tt><a name="(part._next-x_.Review)"></a><span class="stt">next-x</span> <a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28part._review%29" data-pltdoc="x">Review</a></h5><p>After completing the implementation of <span class="stt">next-x</span>, the next design recipe step
is the <a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28part._review%29" data-pltdoc="x">review</a> step. Don’t skip this step. You may be asked
about your review steps during your code walk.</p><p></p><div class="SIntrapara">The above <span class="stt">next-x</span> is <a href="https://course.ccs.neu.edu/cs5010sp15/style.html" data-pltdoc="x">stylistically</a> valid since:
</div><div class="SIntrapara"><ul><li><p>we
<a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28tech._gl~3ano._double._decomp%29" class="techoutside" data-pltdoc="x"><span class="techinside">decompose only one kind of data</span></a>,
<span class="stt">Direction</span>,</p></li><li><p>the right-hand side of each
<span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> branch is valid <a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28tech._function._composition%29" class="techoutside" data-pltdoc="x"><span class="techinside">function composition</span></a>, since
we may decompose one <a href="https://course.ccs.neu.edu/cs5010sp15/predatadefs.html#%28tech._boolean%29" class="techoutside" data-pltdoc="x"><span class="techinside">boolean</span></a> per <a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28tech._function._composition%29" class="techoutside" data-pltdoc="x"><span class="techinside">function composition</span></a>
(i.e., we may use one <span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._if%29%29" class="RktStxLink" data-pltdoc="x">if</a></span>).</p></li></ul></div><p></p><p></p><div class="SIntrapara">However, we should not be satisfied with our current <span class="stt">next-x</span> implementation.
Here are some potential problems (some programmers might refer to these as
<a href="http://en.wikipedia.org/wiki/Code_smell">code smells</a>):
</div><div class="SIntrapara"><ul><li><p>The function consumes and produces Coordinates and thus should represent
a "Coordinate task". However the function requires a <span class="stt">Ball</span> property
(<span class="stt">BALL-RADIUS</span>) to do its computation and the output is only meaningful
when it’s part of a <span class="stt">Ball</span>. Thus the function doesn’t make sense when
viewed independently so we need to rewrite it.</p><blockquote><p class="boxed"><span style="font-weight: bold">Review Guideline 1: </span><a name="(tech._gl~3atask._data._consistency)"></a><span style="font-style: italic">Check that a function’s "task" makes sense for the kind of
data it consumes and produces, and that its output is not
dependent on a specific context.</span></p></blockquote></li><li><p></p><div class="SIntrapara">The function is somewhat long and complicated, such that someone
looking at it can’t tell what it does right away. A good indicator of a
too-complicated function is when we can’t write a clear, concise
<a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28tech._purpose._statement%29" class="techoutside" data-pltdoc="x"><span class="techinside">purpose statement</span></a>. The purpose statement we wrote is way too long.
</div><div class="SIntrapara"><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>While editing your prose for clarity and conciseness is
always a good idea during the review step, this tutorial’s
focus is a function’s implementation so we don’t introduce
a formal guideline for editing the purpose statement.</p></blockquote></blockquote></blockquote></div><p></p></li><li><p>The expressions <span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="stt"> </span><span class="RktSym">x</span><span class="stt"> </span><span class="RktSym">VELOCITY</span><span class="RktPn">)</span> and <span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="stt"> </span><span class="RktSym">x</span><span class="stt"> </span><span class="RktSym">VELOCITY</span><span class="RktPn">)</span> are
repeated.</p></li><li><p>The <span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> right-hand sides have similar shape so there may be
opportunities for abstraction.</p><blockquote><p class="boxed"><span style="font-weight: bold">Review Guideline 2: </span><a name="(tech._gl~3aabstraction)"></a><span style="font-style: italic">Look for abstraction opportunities in
repeated code.</span></p></blockquote></li></ul></div><p></p><p>Regarding the first bullet, it’s clear that the "off canvas" computation
should be a performed by a <span class="stt">Ball</span>-processing function.
However, it’s redundant to re-create a <span class="stt">Ball</span> (and then decompose it again)
after we’ve already decomposed it:</p><blockquote class="Rfilebox"><p class="Rfiletitle"><span class="Rfilename"><span class="stt">don</span><span class="stt">’</span><span class="stt">t decompose and then reconstruct a piece of data</span></span></p><blockquote class="Rfilecontent"><table cellspacing="0" cellpadding="0" class="RktBlk"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">next-x.bad</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">dir</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._if%29%29" class="RktStxLink" data-pltdoc="x">if</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-off-canvas?</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-ball</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">dir</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-off-canvas?.bad</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-x</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-dir</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></blockquote><blockquote><p class="boxed"><span style="font-weight: bold">Review Guideline 3: </span><a name="(tech._gl~3achain._no._double._decomp)"></a><span style="font-style: italic">Check that a chain of function calls only decomposes compound or itemization
data once.</span></p></blockquote><p>Thus, perhaps we should revisit
<span class="stt">next-ball</span>’s implementation to delay decomposition of the <span class="stt">Ball</span>.
Another indication that <span class="stt">next-ball</span> should perhaps not decompose <span class="stt">Ball</span> is
that <span class="stt">next-x</span> needed both parts of the compound <span class="stt">Ball</span> value. When this is
the case, it’s often better to just pass the compound data directly, since the
multiple arguments clutter the program.</p><blockquote><p class="boxed"><span style="font-weight: bold">Review Guideline 4: </span><a name="(tech._gl~3apass._multiple._piece)"></a><span style="font-style: italic">Avoid overeager decomposition.
If a <a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28tech._data._decomposition%29" class="techoutside" data-pltdoc="x"><span class="techinside">data decomposition</span></a> function passes multiple subpieces of
data to other functions, then consider refactoring the function to use
<a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28tech._function._composition%29" class="techoutside" data-pltdoc="x"><span class="techinside">function composition</span></a> and instead pass the whole argument. Or
you may need to refactor your data definitions.</span></p></blockquote><p>A variant of overeager decomposition may require some parts of a compound
data, but other parts get strung through multiple function calls and are not used
until later, again cluttering the code. In this situation, data definition
refactoring is recommended.</p><p>Keep in mind that a function composition function does not decompose <span style="font-style: italic">any</span>
compound or itemization data. As another corollary of the
<a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28tech._gl~3apass._multiple._piece%29" class="techoutside" data-pltdoc="x"><span class="techinside">above guideline</span></a>,
avoid <span style="font-style: italic">partial</span> function composition functions that pass both the whole data
and its pieces.
For example, the following uses neither a function
composition nor a data decomposition strategy:</p><blockquote class="Rfilebox"><p class="Rfiletitle"><span class="Rfilename"><span class="stt">don</span><span class="stt">’</span><span class="stt">t pass on both pieces and the whole compound data</span></span></p><blockquote class="Rfilecontent"><table cellspacing="0" cellpadding="0" class="RktBlk"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">next-ball.bad</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._if%29%29" class="RktStxLink" data-pltdoc="x">if</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">off-canvas?</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-x</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-dir</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">next-x</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-x</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-dir</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></blockquote><h5>6<tt>&nbsp;</tt><a name="(part._next-ball__.Revisited)"></a><span class="stt">next-ball</span>, Revisited</h5><p></p><div class="SIntrapara">Let’s refactor <span class="stt">next-ball</span> to be a composition of <span class="stt">Ball</span>-processing
functions. To determine what functions we need, let’s see if we can think of
discrete <span class="stt">Ball</span> "tasks":
</div><div class="SIntrapara"><ul><li><p>moving a <span class="stt">Ball</span> forward, independent of any canvas edges,</p></li><li><p>checking if a <span class="stt">Ball</span> is off the canvas,</p></li><li><p>moving a <span class="stt">Ball</span> to the edge of a canvas,</p></li><li><p>changing a <span class="stt">Ball</span>’s direction.</p></li></ul></div><p></p><p>These tasks make sense when viewed independently, and thus are consistent with
<a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28tech._gl~3atask._data._consistency%29" class="techoutside" data-pltdoc="x"><span class="techinside">the previous guideline</span></a>. In other words, the
output of the tasks are not dependent
on a specific context. <a href="http://www.ccs.neu.edu/home/matthias/HtDP2e/Draft/part_one.html#%28part._mix._sec~3aitemization-design2%29">As the textbook advises</a>, being able to
identify discrete tasks is another sign that
<a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28tech._function._composition%29" class="techoutside" data-pltdoc="x"><span class="techinside">function composition</span></a> may be appropriate.</p><blockquote><p class="boxed"><span style="font-weight: bold">Review Guideline 5: </span><a name="(tech._gl~3adiscrete._task)"></a><span style="font-style: italic">If you can identify multiple, discrete tasks performed by a
<a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28tech._data._decomposition%29" class="techoutside" data-pltdoc="x"><span class="techinside">data decomposition</span></a> function, consider refactoring the function
to use
<a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28tech._function._composition%29" class="techoutside" data-pltdoc="x"><span class="techinside">function composition</span></a>.</span></p></blockquote><p>Now let’s turn these tasks into functions for our wish list.</p><p>We can keep most of the other design recipe steps unchanged, so we only present
the changed components.</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">next-ball : Ball -&gt; Ball</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Computes the next ball state.</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">STRATEGY: function composition</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">next-ball</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._if%29%29" class="RktStxLink" data-pltdoc="x">if</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-off-canvas?</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-forward</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-reverse-direction</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-to-edge</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-forward</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote><p>Our wish list looks like:</p><p></p><div class="SIntrapara"><span style="font-weight: bold">Wish List</span>:
</div><div class="SIntrapara"><ul><li><table cellspacing="0" cellpadding="0" class="RktBlk" style="display: inline-table; vertical-align: text-top;"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">ball-off-canvas? : Ball -&gt; Boolean</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Returns true if any part of the given Ball is off the canvas.</span></td></tr></tbody></table></li><li><table cellspacing="0" cellpadding="0" class="RktBlk" style="display: inline-table; vertical-align: text-top;"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">ball-forward : Ball -&gt; Ball</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Moves the Ball forward in its Direction by VELOCITY pixels.</span></td></tr></tbody></table></li><li><table cellspacing="0" cellpadding="0" class="RktBlk" style="display: inline-table; vertical-align: text-top;"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">ball-reverse-direction : Ball -&gt; Ball</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Reverses the Direction of the given Ball.</span></td></tr></tbody></table></li><li><table cellspacing="0" cellpadding="0" class="RktBlk" style="display: inline-table; vertical-align: text-top;"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">ball-to-edge : Ball -&gt; Ball</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Moves the given Ball as far as possible in its Direction.</span></td></tr></tbody></table></li></ul></div><p></p><h5>7<tt>&nbsp;</tt><a name="(part._.Ball-processing_.Functions)"></a><span class="stt">Ball</span>-processing Functions</h5><p>Let’s tackle the wish list in order. For brevity, we highlight only the
the interesting design recipe steps. We leave it as an exercise to fill in
the missing requirements.</p><h5>7.1<tt>&nbsp;</tt><a name="(part._ball-off-canvas_)"></a><span class="stt">ball-off-canvas?</span></h5><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">ball-off-canvas? : Ball -&gt; Boolean</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Returns true if any part of b is at or past the left or right canvas edge.</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">begin-for-test</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/rackunit/api.html#%28def._%28%28lib._rackunit%2Fmain..rkt%29._check-true%29%29" class="RktValLink" data-pltdoc="x">check-true</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-off-canvas?</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-ball</span><span class="hspace">&nbsp;</span><span class="RktSym">BALL-X-RIGHT-EDGE</span><span class="hspace">&nbsp;</span><span class="RktSym">RIGHT</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/rackunit/api.html#%28def._%28%28lib._rackunit%2Fmain..rkt%29._check-true%29%29" class="RktValLink" data-pltdoc="x">check-true</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-off-canvas?</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-ball</span><span class="hspace">&nbsp;</span><span class="RktSym">BALL-X-LEFT-EDGE</span><span class="hspace">&nbsp;</span><span class="RktSym">LEFT</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">STRATEGY: function composition</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-off-canvas?</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._or%29%29" class="RktStxLink" data-pltdoc="x">or</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-at/past-left-edge?</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-at/past-right-edge?</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">&lt;Ball edge predicates&gt; : Ball -&gt; Boolean</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Returns true if any part of b is at or past the named edge.</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">STRATEGY: data decomposition on b : Ball</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-at/past-left-edge?</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-x</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">BALL-X-LEFT-EDGE</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-at/past-right-edge?</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3e~3d%29%29" class="RktValLink" data-pltdoc="x">&gt;=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-x</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">BALL-X-RIGHT-EDGE</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote><p></p><div class="SIntrapara">Commentary:
</div><div class="SIntrapara"><ul><li><p>Function examples are important here to precisely illustrate the edge cases.</p></li><li><p>We could have written just one function, but
<a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28tech._gl~3adiscrete._task%29" class="techoutside" data-pltdoc="x"><span class="techinside">separating the tasks</span></a>
improves code readability.</p></li></ul></div><p></p><h5>7.2<tt>&nbsp;</tt><a name="(part._ball-forward)"></a><span class="stt">ball-forward</span></h5><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">ball-forward : Ball -&gt; Ball</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Move ball b by VELOCITY pixels in its current Direction.</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">STRATEGY: data decomposition on b : Ball</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-forward</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-ball</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">x-forward</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-x</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-dir</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-dir</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">x-forward : Coordinate Direction -&gt; Ball</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Move coordinate x by VELOCITY pixels in direction dir.</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">STRATEGY: data decomposition on dir : Direction</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">x-forward</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">dir</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">left?</span><span class="hspace">&nbsp;</span><span class="RktSym">dir</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">VELOCITY</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">right?</span><span class="hspace">&nbsp;</span><span class="RktSym">dir</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">VELOCITY</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote><p></p><div class="SIntrapara">Commentary:
</div><div class="SIntrapara"><ul><li><p>Since the new x Coordinate depends on the direction, to
<a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28tech._gl~3ano._double._decomp%29" class="techoutside" data-pltdoc="x"><span class="techinside">avoid double decomposition</span></a>,
we create a separate <span class="stt">x-forward</span> function.</p></li><li><p>Despite the
<a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28tech._gl~3apass._multiple._piece%29" class="techoutside" data-pltdoc="x"><span class="techinside">"passing multiple pieces" guideline</span></a>,
defining <span class="stt">x-forward</span> is acceptable since we’ve already delayed
decomposing the <span class="stt">Ball</span> as much as possible.</p></li><li><p>The <span class="stt">x-forward</span> function follows the
<a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28tech._gl~3atask._data._consistency%29" class="techoutside" data-pltdoc="x"><span class="techinside">task-data-consistency guideline</span></a>
since its output is not dependent on any context.</p></li></ul></div><p></p><p>In the <a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28part._review%29" data-pltdoc="x">review</a> step, we note that we could define
<span class="stt">ball-forward</span> in terms of a <span class="stt">Ball</span> <a href="http://www.ccs.neu.edu/home/matthias/HtDP2e/Draft/part_one.html#%28part._sec~3aprogstructs%29">x-updater function</a>,
but since this would be the only current use for the updater, we leave the code
as-is and just keep the option in mind for later.</p><h5>7.3<tt>&nbsp;</tt><a name="(part._ball-reverse-direction)"></a><span class="stt">ball-reverse-direction</span></h5><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">ball-reverse-direction : Ball -&gt; Ball</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Reverses the direction of the given ball.</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">STRATEGY: data decomposition on b : Ball</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-reverse-direction</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-ball</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-x</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">reverse-direction</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-dir</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">reverse-direction : Direction -&gt; Direction</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Flips the given direction d.</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">STRATEGY: data decomposition on d : Direction</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">reverse-direction</span><span class="hspace">&nbsp;</span><span class="RktSym">d</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">right?</span><span class="hspace">&nbsp;</span><span class="RktSym">d</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">LEFT</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">left?</span><span class="hspace">&nbsp;</span><span class="RktSym">d</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">RIGHT</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote><p><span class="stt">ball-reverse-direction</span> follows essentially the same design as
<span class="stt">ball-forward</span>. We also note that it could use a <span class="stt">Ball</span>-direction
updater function.</p><h5>7.4<tt>&nbsp;</tt><a name="(part._ball-to-edge)"></a><span class="stt">ball-to-edge</span></h5><p>If we follow the design of <span class="stt">ball-forward</span> and <span class="stt">ball-reverse-direction</span>, we
get the following implementation of <span class="stt">ball-to-edge</span>.</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">ball-to-edge : Ball -&gt; Ball</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Moves b to the furthest edge in the direction it</span><span class="RktCmt">'</span><span class="RktCmt">s facing.</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">STRATEGY: data decomposition on b : Ball</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-to-edge.v1</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">make-ball</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-x-at-edge</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-dir</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-dir</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">ball-x-at-edge : Direction -&gt; Coordinate</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Returns the extreme x coordinate of a ball center,</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">at the edge indicated direction by the direction dir</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">STRATEGY: data decomposition on dir : Direction</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-x-at-edge</span><span class="hspace">&nbsp;</span><span class="RktSym">dir</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">left?</span><span class="hspace">&nbsp;</span><span class="RktSym">dir</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">BALL-X-LEFT-EDGE</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">right?</span><span class="hspace">&nbsp;</span><span class="RktSym">dir</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">BALL-X-RIGHT-EDGE</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote><p>However, <span class="stt">ball-x-at-edge</span> again doesn’t satisfy
<a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28tech._gl~3atask._data._consistency%29" class="techoutside" data-pltdoc="x"><span class="techinside">the task-data-consistency guideline</span></a>
(although the name is better this time, since it indicates that we’re only
concerned with <span class="stt">Ball</span> x’s),
because its output is only meaningful when used as a <span class="stt">Ball</span> field.</p><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>In the review step, we note that as another alternative,
perhaps defining a subset of
Coordinate called <span class="stt">BallXCoordinate</span> would help us in defining
a <span class="stt">ball-x-at-edge</span> function that make sense.
Again, this tutorial’s focus is on implementation, so we don’t introduce a
formal guideline, but think about what this alternate data definition would look
like.</p></blockquote></blockquote></blockquote><p>Instead, we refactor <span class="stt">ball-to-edge</span> to call an <a name="(tech._alternate._constructor)"></a><span style="font-style: italic">alternate constructor</span>,
<span class="stt">make-edge-ball</span>, which consumes a <span class="stt">Direction</span> and returns a <span class="stt">Ball</span>
at the indicated edge of the canvas.</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">ball-to-edge : Ball -&gt; Ball</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Moves b to the furthest edge in the direction it</span><span class="RktCmt">'</span><span class="RktCmt">s facing.</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">STRATEGY: data decomposition on b : Ball</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-to-edge</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-edge-ball</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-dir</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">make-edge-ball : Direction -&gt; Ball</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Constructs a new ball positioned as far as possible in the given Direction,</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">and moving in the opposite direction.</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-edge-ball</span><span class="hspace">&nbsp;</span><span class="RktSym">dir</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">left?</span><span class="hspace">&nbsp;</span><span class="RktSym">dir</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-ball</span><span class="hspace">&nbsp;</span><span class="RktSym">BALL-X-LEFT-EDGE</span><span class="hspace">&nbsp;</span><span class="RktSym">RIGHT</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">right?</span><span class="hspace">&nbsp;</span><span class="RktSym">dir</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-ball</span><span class="hspace">&nbsp;</span><span class="RktSym">BALL-X-RIGHT-EDGE</span><span class="hspace">&nbsp;</span><span class="RktSym">LEFT</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote><p>An alternate constructor’s name should begin with <span class="stt">make-</span> and the function
should consume (some) component data and produce a compound data.</p><blockquote><p class="boxed"><span style="font-weight: bold">Process Guideline 5: </span><a name="(tech._gl~3aalternate._constructor)"></a><span style="font-style: italic">Write <a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28tech._alternate._constructor%29" class="techoutside" data-pltdoc="x"><span class="techinside">alternate constructor</span></a> functions
when appropriate.</span></p></blockquote><p>With this definition of <span class="stt">ball-to-edge</span>, we no longer need
<span class="stt">ball-reverse-direction</span> so the final version of <span class="stt">next-ball</span> looks like:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">next-ball : Ball -&gt; Ball</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Computes the next ball state.</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">STRATEGY: function composition</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">next-ball</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._if%29%29" class="RktStxLink" data-pltdoc="x">if</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-off-canvas?</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-forward</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-to-edge</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-forward</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote><h5>8<tt>&nbsp;</tt><a name="(part._.Summary)"></a>Summary</h5><p>Note we can still find some problems with our solution. For example,
<span class="stt">(ball-forward b)</span> is <a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28tech._gl~3aabstraction%29" class="techoutside" data-pltdoc="x"><span class="techinside">repeated</span></a>.
There will rarely be an optimal solution
however. Designing programs is all about identifying, weighing, and making
tradeoffs.</p><p>For the repeated code, given that the
<span class="stt">Beginner Language</span> does not allow <span class="RktSym">local</span> definitions, to eliminate the
repetition, we would have to define a new function. However, it’s not clear
what <a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28tech._gl~3adiscrete._task%29" class="techoutside" data-pltdoc="x"><span class="techinside">discrete task</span></a> that function would accomplish
(as an exercise, try to name the function),
so given this tradeoff, since the repetition is minor, we leave it as is. (Note
that this is the kind of reasoning we expect to hear during code walks.)</p><p>Our final solution is not the only acceptable solution. In particular, we have
not even considered alternate data definitions. However, this guide’s purpose is
not to explore all possible design decisions, but merely
to illustrate some guidelines you should follow when <span style="font-style: italic">implementing</span> your
programs.</p><p></p><div class="SIntrapara">In summary, here are all the <span style="font-style: italic">process</span> guidelines:
</div><div class="SIntrapara"><ul><li><p><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28tech._gl~3ano._double._decomp%29" class="techoutside" data-pltdoc="x"><span class="techinside">Process Guideline 1</span></a>: <span style="font-style: italic">Decompose one kind of data per function.</span></p></li><li><p><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28tech._gl~3awish._list%29" class="techoutside" data-pltdoc="x"><span class="techinside">Process Guideline 2</span></a>: <span style="font-style: italic">Use a wish list to organize and document your
progress as you write a program.</span></p></li><li><p><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28tech._gl~3acompound._data._decomp%29" class="techoutside" data-pltdoc="x"><span class="techinside">Process Guideline 3</span></a>: <span style="font-style: italic">For functions with <a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28tech._compound._data%29" class="techoutside" data-pltdoc="x"><span class="techinside">compound data</span></a> or
<a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28tech._itemization._data%29" class="techoutside" data-pltdoc="x"><span class="techinside">itemization data</span></a> inputs, start with a
<a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28tech._data._decomposition%29" class="techoutside" data-pltdoc="x"><span class="techinside">data decomposition</span></a> strategy, otherwise use
<a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28tech._function._composition%29" class="techoutside" data-pltdoc="x"><span class="techinside">function composition</span></a>.</span></p></li><li><p><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28tech._gl~3aambiguity%29" class="techoutside" data-pltdoc="x"><span class="techinside">Process Guideline 4</span></a>: <span style="font-style: italic">When encountering ambiguous behavior, ask for clarification, and
then make a reasonable decision if necessary. Be prepared to
explain your decision during a code walk.</span></p></li><li><p><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28tech._gl~3aalternate._constructor%29" class="techoutside" data-pltdoc="x"><span class="techinside">Process Guideline 5</span></a>: <span style="font-style: italic">Write <a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28tech._alternate._constructor%29" class="techoutside" data-pltdoc="x"><span class="techinside">alternate constructor</span></a> functions
when appropriate.</span></p></li></ul></div><p></p><p></p><div class="SIntrapara">And here are the <span style="font-style: italic">review</span> guidelines:
</div><div class="SIntrapara"><ul><li><p><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28tech._gl~3atask._data._consistency%29" class="techoutside" data-pltdoc="x"><span class="techinside">Review Guideline 1</span></a>: <span style="font-style: italic">Check that a function’s "task" makes sense for the kind of
data it consumes and produces, and that its output is not
dependent on a specific context.</span></p></li><li><p><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28tech._gl~3aabstraction%29" class="techoutside" data-pltdoc="x"><span class="techinside">Review Guideline 2</span></a>: <span style="font-style: italic">Look for abstraction opportunities in
repeated code.</span></p></li><li><p><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28tech._gl~3achain._no._double._decomp%29" class="techoutside" data-pltdoc="x"><span class="techinside">Review Guideline 3</span></a>: <span style="font-style: italic">Check that a chain of function calls only decomposes compound or itemization
data once.</span></p></li><li><p><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28tech._gl~3apass._multiple._piece%29" class="techoutside" data-pltdoc="x"><span class="techinside">Review Guideline 4</span></a>: <span style="font-style: italic">Avoid overeager decomposition.
If a <a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28tech._data._decomposition%29" class="techoutside" data-pltdoc="x"><span class="techinside">data decomposition</span></a> function passes multiple subpieces of
data to other functions, then consider refactoring the function to use
<a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28tech._function._composition%29" class="techoutside" data-pltdoc="x"><span class="techinside">function composition</span></a> and instead pass the whole argument. Or
you may need to refactor your data definitions.</span></p></li><li><p><a href="https://course.ccs.neu.edu/cs5010sp15/implementation.html#%28tech._gl~3adiscrete._task%29" class="techoutside" data-pltdoc="x"><span class="techinside">Review Guideline 5</span></a>: <span style="font-style: italic">If you can identify multiple, discrete tasks performed by a
<a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28tech._data._decomposition%29" class="techoutside" data-pltdoc="x"><span class="techinside">data decomposition</span></a> function, consider refactoring the function
to use
<a href="https://course.ccs.neu.edu/cs5010sp15/recipe.html#%28tech._function._composition%29" class="techoutside" data-pltdoc="x"><span class="techinside">function composition</span></a>.</span></p></li></ul></div><p></p><div class="navsetbottom"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="https://course.ccs.neu.edu/cs5010sp15/notes.html" title="backward to &quot;Other Notes&quot;" data-pltdoc="x">← prev</a>&nbsp;&nbsp;<a href="https://course.ccs.neu.edu/cs5010sp15/notes.html" title="up to &quot;Other Notes&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="https://course.ccs.neu.edu/cs5010sp15/set01sol.html" title="forward to &quot;Problem Set 01 Solution&quot;" data-pltdoc="x">next →</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>